
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Two-Body Problem in the Co-Moving Frame &#8212; Orbital Mechanics &amp; Astrodynamics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copyHeaderPermalink.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/copyHeaderPermalink.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"vector": ["\\boldsymbol{#1}", 1], "uvec": ["\\boldsymbol{\\hat{#1}}", 1], "mag": ["\\lVert#1\\rVert", 1], "cross": "\\times", "unit": ["#1~\\mathrm{#2}", 2], "pf": ["\\overline{#1}", 1], "mat": ["\\left[\\mathbf{#1}\\right]", 1], "COG": "\\mathrm{COG}", "KE": "\\mathrm{KE}", "PE": "V"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://orbital-mechanics.space/the-n-body-problem/two-body-relative-numerical-solution.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Circular Restricted Three-Body Problem" href="circular-restricted-three-body-problem.html" />
    <link rel="prev" title="Relative Motion in the Two-Body Problem" href="two-body-relative-motion.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/hohmann.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Orbital Mechanics & Astrodynamics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Orbital Mechanics &amp; Astrodynamics
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/reference-frames.html">
   Reference Frames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/mass-force-and-newtons-law-of-gravitation.html">
   Mass, Force, and Newton’s Law of Gravitation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/force-acceleration-and-momentum.html">
   Force, Acceleration, and Momentum
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  The N-Body Problem
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="two-body-inertial-motion.html">
   Two-Body Equations of Motion in an Inertial Frame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="two-body-inertial-numerical-solution.html">
   Two-Body Numerical Solution in an Inertial Frame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="motion-of-the-barycenter.html">
   Motion of the Barycenter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="two-body-relative-motion.html">
   Relative Motion in the Two-Body Problem
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Two-Body Problem in the Co-Moving Frame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="circular-restricted-three-body-problem.html">
   Circular Restricted Three-Body Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrange-points.html">
   Application of the CR3BP: Lagrange Points
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lagrange-points-example.html">
   Example: Plotting Lagrange Points
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jacobi-constant.html">
   The Jacobi Constant
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Equations-of-Motion-CR3BP.html">
   Example: CR3BP Equations of Motion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="many-body-problems.html">
   Many-Body Problems
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Constants of Orbital Motion
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../constants-of-orbital-motion/energy-is-conserved-in-orbital-motion.html">
   Energy Is Conserved In Orbital Motion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../constants-of-orbital-motion/angular-momentum-is-conserved.html">
   Angular Momentum Is Conserved In Orbital Motion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../constants-of-orbital-motion/orbital-plane-and-keplers-second-law.html">
   Orbital Plane and Kepler’s Second Law
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  The Orbit Equation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/the-orbit-equation.html">
   The Orbit Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/orbital-nomenclature.html">
   Orbital Nomenclature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/circular-orbits.html">
   Circular Orbits (
   <span class="math notranslate nohighlight">
    \(e = 0\)
   </span>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/elliptical-orbits.html">
   Chapter 2.7 - Elliptical Orbits (
   <span class="math notranslate nohighlight">
    \(0 &lt; e &lt; 1\)
   </span>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/parabolic-trajectories.html">
   Chapter 2.8 - Parabolic Trajectories (
   <span class="math notranslate nohighlight">
    \(e = 1\)
   </span>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/hyperbolic-trajectories.html">
   Chapter 2.9 - Hyperbolic Trajectories (
   <span class="math notranslate nohighlight">
    \(e &gt; 1\)
   </span>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/perifocal-frame.html">
   Chapter 2.10 - Perifocal Frame
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../the-orbit-equation/the-lagrange-coefficients.html">
   Chapter 2.11 - The Lagrange Coefficients
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Review of Vectors, Kinematics, and Newtonian Mechanics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../review/kinematics.html">
   Kinematics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../review/time-derivatives-of-moving-vectors.html">
   Time Derivatives of Moving Vectors
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/celestial-sphere.html">
   Celestial Sphere
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/relative-motion.html">
   Relative Motion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/planetary-parameters.html">
   Planetary Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/gravity-and-spherical-symmetry.html">
   Gravity and Spherical Symmetry
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Bibliography
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/the-n-body-problem/two-body-relative-numerical-solution.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/the-n-body-problem/two-body-relative-numerical-solution.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/bryanwweber/orbital-mechanics-notes"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/bryanwweber/orbital-mechanics-notes/issues/new?title=Issue%20on%20page%20%2Fthe-n-body-problem/two-body-relative-numerical-solution.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/bryanwweber/orbital-mechanics-notes/edit/main/the-n-body-problem/two-body-relative-numerical-solution.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bryanwweber/orbital-mechanics-notes/main?urlpath=tree/the-n-body-problem/two-body-relative-numerical-solution.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="two-body-problem-in-the-co-moving-frame">
<h1>Two-Body Problem in the Co-Moving Frame<a class="headerlink" href="#two-body-problem-in-the-co-moving-frame" title="Permalink to this headline">¶</a></h1>
<p>Recall the equations of motion for the two-body problem in a reference frame attached to <span class="math notranslate nohighlight">\(m_1\)</span>, Eq. <a class="reference internal" href="two-body-relative-motion.html#equation-eq-two-body-relative-motion-components">(40)</a>, repeated here for reference:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \ddot{x} &amp;= -\mu \frac{x}{r^3} \\
  \ddot{y} &amp;= -\mu \frac{y}{r^3} \\
  \ddot{z} &amp;= -\mu \frac{z}{r^3}
\end{aligned}\end{split}\]</div>
<p>In this example, we will solve the two-body problem in relative coordinates. Although the problem is in relative coordinates, the solution procedure is the same as <a class="reference internal" href="two-body-inertial-numerical-solution.html"><span class="doc std std-doc">Two-Body Numerical Solution in an Inertial Frame</span></a>. In Python, the first thing is to import the required libraries. This step is not necessary in Matlab.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># noqa: F401, needed for 3d plots</span>

</pre></div>
</div>
</div>
</div>
<p>A 1000 kg satellite is in orbit around Earth. The initial position and velocity of the satellite are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \vector{r}_0 &amp;= \left(8000 \uvec{\imath} + 6000 \uvec{k}\right)\ \mathrm{km} \\
  \dot{\vector{r}}_0 &amp;= 7.0 \uvec{\jmath}\ \mathrm{km/s}
\end{aligned}\end{split}\]</div>
<p>We want to determine the minimum and maximum altitude, and the satellite’s speed at those two locations. The altitude of the satellite is its height above the earth’s surface. The radius of the earth is 6378.12 km.</p>
<p>To avoid confusion with the <span class="math notranslate nohighlight">\(y\)</span> coordinate, we will use capital <span class="math notranslate nohighlight">\(Y\)</span> for the state vector. Remember that the state vector includes 6 components, 3 positions and 3 velocities. These all need to be stored in one array.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="mf">6.67430e-20</span>  <span class="c1"># km**3/(kg * s**2)</span>
<span class="n">m_1</span> <span class="o">=</span> <span class="mf">5.97219e24</span>  <span class="c1"># kg</span>
<span class="n">m_2</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># kg</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">G</span> <span class="o">*</span> <span class="n">m_1</span>
<span class="n">R_E</span> <span class="o">=</span> <span class="mf">6378.12</span>  <span class="c1"># km</span>

<span class="n">r_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">8000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6000</span><span class="p">))</span>  <span class="c1"># km</span>
<span class="n">v_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># km/s</span>
<span class="n">Y_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">r_0</span><span class="p">,</span> <span class="n">v_0</span><span class="p">))</span>


</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">two_body_relative_numerical_solution</span>
    <span class="n">G</span> <span class="o">=</span> <span class="mf">6.67430e-20</span><span class="p">;</span> <span class="o">%</span> <span class="n">km</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">kg</span> <span class="o">*</span> <span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="mf">5.97219e24</span><span class="p">;</span> <span class="o">%</span> <span class="n">kg</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span> <span class="o">%</span> <span class="n">kg</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">G</span> <span class="o">*</span> <span class="n">m1</span><span class="p">;</span> <span class="o">%</span> <span class="n">km</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span>
    <span class="n">RE</span> <span class="o">=</span> <span class="mf">6378.12</span><span class="p">;</span> <span class="o">%</span> <span class="n">km</span>

    <span class="n">r0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8000</span> <span class="mi">0</span> <span class="mi">6000</span><span class="p">];</span> <span class="o">%</span> <span class="n">km</span>
    <span class="n">v0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">7</span> <span class="mi">0</span><span class="p">];</span> <span class="o">%</span> <span class="n">km</span><span class="o">/</span><span class="n">s</span>
    <span class="n">Y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">r0</span> <span class="n">v0</span><span class="p">];</span>

</pre></div>
</div>
</div>
</div>
<p>Then, we need to define the function that describes the motion of our system. This function needs to compute the derivative of the state vector and return it to the solver.</p>
<p>Inside the function, we use the values in the state vector to fill the <code class="docutils literal notranslate"><span class="pre">Ydot</span></code> vector. Then, we return <code class="docutils literal notranslate"><span class="pre">Ydot</span></code> back to the solver.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">relative_motion</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the motion of a two-body system relative to $m_1$.</span>

<span class="sd">    The state vector ``Y`` should be in the order:</span>

<span class="sd">    1. Coordinates of $m_2$ relative to $m_1$</span>
<span class="sd">    2. Velocity components of $m_2$ relative to $m_1$</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the three position components</span>
    <span class="n">r_vec</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

    <span class="c1"># Create the derivative vector and copy the velocities into it</span>
    <span class="n">Ydot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Ydot</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>

    <span class="c1"># Calculate the accelerations</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">r_vec</span><span class="p">)))</span>
    <span class="n">a_vec</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">*</span> <span class="n">r_vec</span> <span class="o">/</span> <span class="n">r</span> <span class="o">**</span> <span class="mi">3</span>
    <span class="n">Ydot</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="n">a_vec</span>

    <span class="k">return</span> <span class="n">Ydot</span>


</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">function</span> <span class="n">Ydot</span> <span class="o">=</span> <span class="n">relative_motion</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
        <span class="n">rvector</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">);</span>
        <span class="n">vvector</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">);</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">rvector</span><span class="p">);</span>
        <span class="n">avector</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">.*</span> <span class="n">rvector</span> <span class="o">./</span> <span class="n">r</span><span class="o">.^</span><span class="mi">3</span><span class="p">;</span>
        <span class="n">Ydot</span> <span class="o">=</span> <span class="p">[</span><span class="n">vvector</span><span class="p">;</span> <span class="n">avector</span><span class="p">];</span>
    <span class="n">end</span>
</pre></div>
</div>
</div>
</div>
<p>With the function defined, we can call the solver function. We need to tell it the function it should solve, the beginning and end times, the initial state vector, and then some information to help control the output.</p>
<p>We will guess the final time and check that increasing it does not change the answers for minimum and maximum altitude.</p>
<p>In Python, once the solver finishes, the solution is stored in <code class="docutils literal notranslate"><span class="pre">sol.y</span></code>. Each column of <code class="docutils literal notranslate"><span class="pre">sol.y</span></code> corresponds to a single timestep and each row corresponds to one of the state variables. It is more convenient to work with the transpose of this array, so we do that and define <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t_0</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># seconds</span>
<span class="n">t_f</span> <span class="o">=</span> <span class="mi">14_709</span>  <span class="c1"># seconds, period of one orbit</span>
<span class="n">t_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">relative_motion</span><span class="p">,</span> <span class="p">[</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">],</span> <span class="n">Y_0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_points</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># km</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>  <span class="c1"># km/s</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">%</span> <span class="n">seconds</span>
    <span class="n">tf</span> <span class="o">=</span> <span class="mi">14709</span><span class="p">;</span> <span class="o">%</span> <span class="n">seconds</span><span class="p">,</span> <span class="n">period</span> <span class="n">of</span> <span class="n">one</span> <span class="n">orbit</span>
    <span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">Y</span><span class="p">]</span> <span class="o">=</span> <span class="n">ode45</span><span class="p">(</span><span class="nd">@relative_motion</span><span class="p">,</span> <span class="p">[</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">],</span> <span class="n">Y0</span><span class="p">);</span>

    <span class="n">rvec</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">);</span>
    <span class="n">vvec</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">);</span>

</pre></div>
</div>
</div>
</div>
<p>Since we are looking for the minimum and maximum <em>altitude</em>, we need to calculate the distance of the satellite from the center of the earth and then subtract the radius of the earth. This will give the altitude above the surface:</p>
<div class="math notranslate nohighlight" id="equation-eq-earth-altitude-definition">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-earth-altitude-definition" title="Permalink to this equation">¶</a></span>\[h = \mag{\vector{r}} - R_E\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the altitude and <span class="math notranslate nohighlight">\(R_E\)</span> is the radius of the earth. Similarly, the speed is the magnitude of the velocity.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># altitude is the distance above the surface of the Earth</span>
<span class="n">altitude</span> <span class="o">=</span> <span class="n">r_mag</span> <span class="o">-</span> <span class="n">R_E</span>

<span class="n">speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">rmag</span> <span class="o">=</span> <span class="n">vecnorm</span><span class="p">(</span><span class="n">rvec</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">altitude</span> <span class="o">=</span> <span class="n">rmag</span> <span class="o">-</span> <span class="n">RE</span><span class="p">;</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="n">vecnorm</span><span class="p">(</span><span class="n">vvec</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

</pre></div>
</div>
</div>
</div>
<p>Now we can process the arrays to find the minimum and maximum altitude, and the speed at those locations. In Python, there are separate functions to find the minimum/maximum and its index; in Matlab, there is a single function to do both.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">altitude</span><span class="p">)</span>
<span class="n">i_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">altitude</span><span class="p">)</span>

<span class="n">max_altitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">altitude</span><span class="p">)</span>
<span class="n">i_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">altitude</span><span class="p">)</span>

<span class="n">speed_at_min_alt</span> <span class="o">=</span> <span class="n">speed</span><span class="p">[</span><span class="n">i_min</span><span class="p">]</span>
<span class="n">speed_at_max_alt</span> <span class="o">=</span> <span class="n">speed</span><span class="p">[</span><span class="n">i_max</span><span class="p">]</span>
<span class="n">time_at_min_alt</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i_min</span><span class="p">]</span>
<span class="n">time_at_max_alt</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">i_max</span><span class="p">]</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">[</span><span class="n">min_altitude</span><span class="p">,</span> <span class="n">imin</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">altitude</span><span class="p">);</span>
    <span class="p">[</span><span class="n">max_altitude</span><span class="p">,</span> <span class="n">imax</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">altitude</span><span class="p">);</span>
    
    <span class="n">speed_at_min_alt</span> <span class="o">=</span> <span class="n">speed</span><span class="p">(</span><span class="n">imin</span><span class="p">);</span>
    <span class="n">speed_at_max_alt</span> <span class="o">=</span> <span class="n">speed</span><span class="p">(</span><span class="n">imax</span><span class="p">);</span> 
    <span class="n">time_at_min_alt</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">imin</span><span class="p">);</span>
    <span class="n">time_at_max_alt</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">imax</span><span class="p">);</span>    
    
</pre></div>
</div>
</div>
</div>
<p>Finally, we can print the results to the screen.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">The minimum altitude during the orbit is: </span><span class="si">{</span><span class="n">min_altitude</span><span class="si">:</span><span class="s2">.2F</span><span class="si">}</span><span class="s2"> km</span>
<span class="s2">The speed at the minimum altitude is: </span><span class="si">{</span><span class="n">speed_at_min_alt</span><span class="si">:</span><span class="s2">.2F</span><span class="si">}</span><span class="s2"> km/s</span>
<span class="s2">The time at minimum altitude is: </span><span class="si">{</span><span class="n">time_at_min_alt</span><span class="si">:</span><span class="s2">.2F</span><span class="si">}</span><span class="s2"> s</span>
<span class="s2">The maximum altitude during the orbit is: </span><span class="si">{</span><span class="n">max_altitude</span><span class="si">:</span><span class="s2">.2F</span><span class="si">}</span><span class="s2"> km</span>
<span class="s2">The velocity at the maximum altitude is: </span><span class="si">{</span><span class="n">speed_at_max_alt</span><span class="si">:</span><span class="s2">.4F</span><span class="si">}</span><span class="s2"> km/s</span>
<span class="s2">The time at maximum altitude is: </span><span class="si">{</span><span class="n">time_at_max_alt</span><span class="si">:</span><span class="s2">.2F</span><span class="si">}</span><span class="s2"> s</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="p">)</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">fprintf</span><span class="p">(</span><span class="s1">&#39;The minimum altitude during the orbit is: </span><span class="si">%8.2f</span><span class="s1"> km</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">min_altitude</span><span class="p">)</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s1">&#39;The speed at the minimum altitude is: </span><span class="si">%8.2f</span><span class="s1"> km/s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">speed_at_min_alt</span><span class="p">)</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s1">&#39;The time at minimum altitude is: </span><span class="si">%8.2f</span><span class="s1"> s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">time_at_min_alt</span><span class="p">)</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s1">&#39;The maximum altitude during the orbit is: </span><span class="si">%8.2f</span><span class="s1"> km</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">max_altitude</span><span class="p">)</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s1">&#39;The speed at the maximum altitude is: </span><span class="si">%8.2f</span><span class="s1"> km/s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">speed_at_max_alt</span><span class="p">)</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="s1">&#39;The time at maximum altitude is: </span><span class="si">%8.2f</span><span class="s1"> s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">time_at_max_alt</span><span class="p">)</span>

</pre></div>
</div>
</div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>The minimum altitude during the orbit is: 3621.88 km
The speed at the minimum altitude is: 7.00 km/s
The time at minimum altitude is: 0.00 s
The maximum altitude during the orbit is: 9431.85 km
The velocity at the maximum altitude is: 4.4353 km/s
The time at maximum altitude is: 7288.57 s
</pre></div>
</div>
<p>Interestingly, the results from Python and Matlab are slightly different. This is most likely because of different time resolution from the solvers. Now let’s plot the orbit. The central sphere is representative of the earth.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Orbit&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;km&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;km&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;km&quot;</span><span class="p">)</span>

<span class="c1"># This adds a sphere to the plot of the radius of the Earth</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">P</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">R_E</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">R_E</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">R_E</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i_min</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">i_min</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">i_min</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Min. Altitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i_max</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">i_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">i_max</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;go&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Max. Altitude&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">Matlab</label><div class="tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">figure</span><span class="p">()</span>
    <span class="p">[</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">zz</span><span class="p">]</span> <span class="o">=</span> <span class="n">sphere</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
    <span class="n">surf</span><span class="p">(</span><span class="n">RE</span><span class="o">*</span><span class="n">xx</span><span class="p">,</span> <span class="n">RE</span><span class="o">*</span><span class="n">yy</span><span class="p">,</span> <span class="n">RE</span><span class="o">*</span><span class="n">zz</span><span class="p">)</span>
    <span class="n">colormap</span><span class="p">(</span><span class="n">light_blue</span><span class="p">)</span>
    <span class="n">caxis</span><span class="p">([</span><span class="o">-</span><span class="n">RE</span><span class="o">/</span><span class="mi">100</span> <span class="n">RE</span><span class="o">/</span><span class="mi">100</span><span class="p">])</span>
    <span class="n">shading</span> <span class="n">interp</span>

    <span class="o">%</span>   <span class="n">Draw</span> <span class="ow">and</span> <span class="n">label</span> <span class="n">the</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="ow">and</span> <span class="n">Z</span> <span class="n">axes</span>
    <span class="n">line</span><span class="p">([</span><span class="mi">0</span> <span class="mi">2</span><span class="o">*</span><span class="n">RE</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">]);</span>
    <span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">RE</span> <span class="o">+</span> <span class="n">RE</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">line</span><span class="p">([</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span><span class="o">*</span><span class="n">RE</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">]);</span>
    <span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">RE</span> <span class="o">+</span> <span class="n">RE</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">line</span><span class="p">([</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span><span class="o">*</span><span class="n">RE</span><span class="p">]);</span>
    <span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">RE</span> <span class="o">+</span> <span class="n">RE</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>

    <span class="n">hold</span> <span class="n">on</span>
    <span class="n">plot3</span><span class="p">(</span><span class="n">rvec</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plot3</span><span class="p">(</span><span class="n">rvec</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;.r&#39;</span><span class="p">)</span>
    <span class="n">text</span><span class="p">(</span><span class="n">rvec</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;Min. Altitude&#39;</span><span class="p">)</span>
    <span class="n">plot3</span><span class="p">(</span><span class="n">rvec</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;.g&#39;</span><span class="p">)</span>
    <span class="n">text</span><span class="p">(</span><span class="n">rvec</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">rvec</span><span class="p">(</span><span class="n">imax</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;Max. Altitude&#39;</span><span class="p">)</span>

    <span class="n">view</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">.4</span><span class="p">])</span>

    <span class="o">%</span>   <span class="n">Specify</span> <span class="n">some</span> <span class="n">properties</span> <span class="n">of</span> <span class="n">the</span> <span class="n">graph</span>
    <span class="n">grid</span> <span class="n">on</span>
    <span class="n">axis</span> <span class="n">equal</span>
    <span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
    <span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
    <span class="n">zlabel</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
 
    <span class="n">function</span> <span class="nb">map</span> <span class="o">=</span> <span class="n">light_blue</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">r</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
        <span class="nb">map</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="n">g</span> <span class="n">b</span>
               <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
               <span class="n">r</span> <span class="n">g</span> <span class="n">b</span><span class="p">];</span>
    <span class="n">end</span>

</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="figure align-default" id="fig-two-body-relative">
<div class="cell_output docutils container">
<div class="output text_html"><div id="scene" style="width: 100%"></div>
<div
  id="scene-gui"
  style="width: 100%; position: relative; top: -400px; left: 0px"
></div>
<script type="module">
  import {
    CanvasTexture,
    MeshBasicMaterial,
    Mesh,
    PlaneGeometry,
    Scene,
    Color,
    PerspectiveCamera,
    AmbientLight,
    WebGLRenderer,
    Box3,
    Vector3,
    AnimationMixer,
    Clock,
    DoubleSide,
    sRGBEncoding,
  } from "/js/three/build/three.module.js";
  import { GLTFLoader } from "/js/three/examples/jsm/loaders/GLTFLoader.js";
  import { OrbitControls } from "/js/three/examples/jsm/controls/OrbitControls.js";
  import { GUI } from "/js/three/examples/jsm/libs/dat.gui.module.js";

  let camera, scene, renderer, controls, gltfScene;
  let mixer, clock, container, guiContainer, gui;
  const height = 400;
  let width;
  init();
  animate();
  function init() {
    container = document.getElementById("scene");

    scene = new Scene();
    // scene.background = new Color(0xffffff);

    width = container.clientWidth;
    camera = new PerspectiveCamera(60, width / height, 0.25, 10000000);
    scene.add(camera);

    scene.add(new AmbientLight(0xffffff, 10));

    renderer = new WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(width, height);
    renderer.outputEncoding = sRGBEncoding;
    container.appendChild(renderer.domElement);

    controls = new OrbitControls(camera, renderer.domElement);
    controls.minDistance = 100;
    controls.maxDistance = 300;
    controls.screenSpacePanning = true;

    guiContainer = document.getElementById("scene-gui");
    gui = new GUI({ width: 320, autoPlace: false });
    guiContainer.appendChild(gui.domElement);

    let properties = { labelsVisible: true };
    let materials = [];
    let labelController = gui.add(properties, "labelsVisible");
    labelController.name("Show labels");
    labelController.onChange(() => {
      materials.forEach((mat) => {
        mat.visible = properties.labelsVisible;
      });
    });
    const loader = new Promise((resolve, reject) => {
      const ldr = new GLTFLoader();
      ldr.load(
        "/models/two-body-relative.glb",
        function (gltf) {
          // Call this here to make sure everything is loaded before rendering.
          // This load function is async
          resolve(gltf);
        },
        undefined,
        function (error) {
          console.error(error);
        }
      );
    });
    loader.then((gltf) => {
      gltfScene = gltf.scene;

      const box = new Box3().setFromObject(gltfScene);
      const size = box.getSize(new Vector3()).length();
      const center = box.getCenter(new Vector3());

      function getTextMesh(text) {
        const canvas = document.createElement("canvas");
        const context = canvas.getContext("2d");
        context.font = "40px sans-serif";
        context.fillStyle = "rgba(255,255,255,1)";
        context.textAlign = "left";
        context.fillText(text, 0, 60);

        // canvas contents will be used for a texture
        const texture = new CanvasTexture(canvas);

        const material = new MeshBasicMaterial({
          map: texture,
          side: DoubleSide,
        });
        material.transparent = true;
        materials.push(material);

        const mesh = new Mesh(new PlaneGeometry(200, 100), material);
        return mesh;
      }

      const minAltitude = getTextMesh("Min. Altitude");
      gltfScene.getObjectByName("min-altitude").add(minAltitude);
      const maxAltitude = getTextMesh("Max. Altitude");
      gltfScene.getObjectByName("max-altitude").add(maxAltitude);

      scene.add(gltfScene);

      gltfScene.position.x += gltfScene.position.x - center.x;
      gltfScene.position.y += gltfScene.position.y - center.y;
      gltfScene.position.z += gltfScene.position.z - center.z;
      camera.near = size / 100;
      camera.far = size * 100;
      camera.updateProjectionMatrix();

      camera.position.copy(center);
      camera.position.x -= size / 5.0;
      camera.position.y += size / 2.0;
      camera.position.z += size;
      camera.lookAt(center);
      controls.update();

      mixer = new AnimationMixer(gltfScene);
      mixer.clipAction(gltf.animations[0]).play();
      mixer.timeScale = 1.0;
      gui.add(mixer, "timeScale", 0, 3).name("Animation Speed");

      clock = new Clock();

      animate();
    }, undefined);
    new ResizeObserver(() => handleResize()).observe(container);
  }

  function handleResize() {
    width = container.clientWidth;
    camera.aspect = width / height;
    camera.updateProjectionMatrix();
    renderer.setSize(width, height);
    animate();
  }

  function animate() {
    requestAnimationFrame(animate);

    // Check whether these are defined due to the async
    // loading of the file
    if (mixer && clock) {
      mixer.update(clock.getDelta() * mixer.timeScale);
    }
    if (scene && camera) {
      renderer.render(scene, camera);
    }
  }
</script>
</div></div>
<p class="caption"><span class="caption-number">Fig. 13 </span><span class="caption-text">The motion of a satellite in orbit around the earth.</span><a class="headerlink" href="#fig-two-body-relative" title="Permalink to this image">¶</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./the-n-body-problem"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="two-body-relative-motion.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Relative Motion in the Two-Body Problem</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="circular-restricted-three-body-problem.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Circular Restricted Three-Body Problem</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Bryan Weber<br/>
        
          <div class="extra_footer">
            <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://orbital-mechanics.space">Orbital Mechanics & Astrodynamics</a> by <span property="cc:attributionName">Bryan Weber</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>